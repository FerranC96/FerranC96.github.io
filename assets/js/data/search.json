[ { "title": "Building a Platform for Integrative Discovery and Diagnostics in Cancer", "url": "/posts/POPIDD/", "categories": "Research, Conference/Event", "tags": "", "date": "2025-01-01 00:00:00 +0000", "snippet": "The aim of this post is to improve the accessibility of the talks given at the 2nd Networking Event: Empowering Healthcare with Automated Analysis by providing with the notes used for the oral presentation. A PDF copy of the slides can be downloaded from hereIntroductionPresentationHello everyone, after Carlos’ wonderful and thought-provoking talk I will try and present within mine and the collected efforts of the Integrated Pathology Unit towards building a platform for Integrative Discovery and Diagnosis in Cancer. My presenter notes and a copy of the slides can be found on the site by scanning this QR code here.BackgroundSo, to begin with let me talk a bit about myself. I did a bachelor’s in Biotechnology at the University of Barcelona, during the last year of which I actually came to London to work on my thesis. There I realised two things: first, that London was a wonderful place and that I wanted to stay there, secondly, that I found much more enjoyment analysing the data I was generating in the wet lab. It was then that I decided to pivot towards fully computational roles, doing a master’s in bioinformatics and theoretical systems biology at Imperial and a PhD in computational biology at UCL’s Cancer Institute. During my PhD I worked at Chris Tape’s lab towards understanding colorectal cancer biology and chemotherapy resistance using single-cell omic technologies and organoids as model. I worked on developing and publishing tools for mass cytometry data analysis, published a piece on the phenoscape of colonic stem cell regulation together with Xiao Qin (a former postdoc in Tape Lab that now leads her own lab in Oxford), and worked on exploring the use of knowledge graphs for capturing and interrogating cellular communications.The Integrated Pathology UnitNow as I introduced earlier, I am part of the Integrated Pathology Unit, together with my colleague Priya and having had the pleasure to host Carlos for his sabbatical from City during 2024. The IPU is actually a very unique setting, nestled in between the research-focused Institute of Cancer Research, and the clinically-focused Royal Marsden Hospital.At the IPU we work not just with digital pathology images from different modalities, from H&amp;amp;E to IHC and multiplex immunofluorescence, but are also incorporating higher dimensional technologies like Celldive and spatial transcriptomics. All in all, there is a veritable wealth of data passing through the IPU, especially considering that we work with most types of solid tumour cancer, but as many of you here know, massive amounts of data don’t necessarily equate to knowledge. In our particular setting, this challenge is compounded by the need to work with this many data modalities, so are setting out to develop our own analysis platform, POPIDD.POPIDDPOPIDD, or Pathomics Platform for Integrative Discovery and Diagnostics represents our effort towards a solution able to work with not only the imaging modalities I just described, but also the associated clinical data so information can be extracted (including feature extraction and analysis) and integrated (using common data structures), ultimately leading to an increased understanding of clinical and biological processes. This is a growing framework centred around a modular backend (being developed almost exclusively in Python), so that we can consistently reuse in-house tools and also easily incorporate off-the-shelf models. Additionally, the IPU is a wet-lab heavy group, so being very conscious of the need for accessibility in empowering non-computational colleagues, we are also extending on the open source high-dimensional data viewer Napari to build an interface for POPIDD.BackendPOPIDDs main pipeline remains unreleased beyond internal use for now, but elements like napari plugins and python packages (that can work either in a standalone way or as part of POPIDD) have already been released. See here popid-io, a napari plugin for reading digital pathology images and annotations as GeoJSONs and parquet files, or pyhscore, a simple package to compute pixel-wise H-scores. Again, as I mentioned earlier, we are focused on building accessible interfaces for these tools, so on the following slides I will show you some use cases of the custom napari interface accessible from POPIDD’s main pipeline.FrontendThis is the interface, with custom widgets on the right. See for example on the upper right the batch loading popid-io widget, loading the shown mIF image, its channel metadata on the left, and adjusting the viewers scale bar. POPIDD’s interface incorporates a series of tabs for the different main components of the tool, we will begin here by talking about the tissue and cell segmentation tab, which uses both in-house and third party models.I also wanted to show here how we integrate standalone packages, in this case our own pyhscore package, that can be used to quickly quantify IHC images.Finally, there is also a module for aligning TMAs, so their cores can be mapped to the appropriate sample or patient ID before downstream analysis. The widget here uses the Python implementation of this pipeline, but those of you that came to CBIAS might remember how we also talked about a matlab version (perhaps a bit more performant than this one …) developed by Carlos.Application on Epi700 cohortI now wanted to take the last slide of my talk to show a real-life use case of POPIDD in the context of analysing a clinical colorectal cancer cohort. Some of you might find this familiar as it is very similar to the work I presented some months ago at CBIAS. Based on robust signal processing methods, TMAAP identifies the core layout on TMA slides and maps them to their relevant patient and sample IDs. Mapping alignment scores inform the confidence of the ID assignations, which can be visually inspected through a customised interface of the multi-dimensional image viewer napari. We validate TMAAP’s performance by applying it to the Epi700 colorectal cancer cohort, consisting of over 30 thousand individual immunohistochemistry (IHC) and H&amp;amp;E core images. TMAAP can accurately map these images to tumour and stromal samples for each patient. Following downstream IHC quantification, we then recapitulate known clinical and molecular features across all patients; including expected biological interactions between IHC targets and greater degrees of immune involvement in microsatellite instable and BRAF mutant tumours.Closing remarksHopefully by now I have shown the idea that, not only is it crucial for us to develop, share, and use great tools advancing our research, but also that we have to be especially mindful of accessibility. Therefore, using graphical interfaces bypasses in my experience one of the main barriers to non-computational colleagues; the dreaded command line interface. I also wanted to take this time to highlight the IPU’s software repository, where myself, Priya and Carlos have been working on these tools and releasing some of them.Thank you for your time and acknowledge all great people!" }, { "title": "Demonstration of our Multimodal Analytical Platform for the Delivery of Integrated Diagnostics in Oncology", "url": "/posts/MultimodalAP4IDD/", "categories": "Research, Publication", "tags": "", "date": "2024-12-04 00:00:00 +0000", "snippet": "Video DemoStructured TranscriptPOETIC-FoundrySo this is the landing page from the ICR-Foundry accelerator that was done in late 2023. And as you can see, basically, we have here access to certain key applications that we’ll be showcasing in later. And we also have access to some highlighted resources, including the landing page itself, but also the ontology and the filesystem containing all of the all of the data and also outputs from the analysis here within the Foundry platform. And as you can see down here below, we also have highlighted here an overview of the ontology.The Ontology [T-00:42:28]So this is essentially a graph based representation of the POETIC clinical trial in which we have basically different layers of information. So these different nodes are coloured according to the type of data. They contain the type of resource that they are within this ontology. And within here we can see the inputs. Essentially, we have like all of the clinical information about the patients, but we also have gene expression information from experiments performed here at the ICR and essentially through a series of transforms and analyses here in the Foundry platform, we were then able to essentially could use a series of outputs. These outputs they can be data access themselves. I mean for subsequent analysis or they can also be applications and widgets. such as this one so here we have, for example, some of the applications that we are showing up here on the top we have the image explorer. We also have the clinical trial data and splitting tool, as well as the sample cohorting analysis tool here and a couple of widgets we will also showcase some of them. in this presentation finally as well, this ontology is useful not just to have an overview of the objects that we have, the kind of data that they contain, but also, for example, to, to showcase ability of foundry to to modulate and in a granular manner to control the permissions that a particular user has to look at it and access the different the different types of data. So for example this is viewing the ontology and colouring of the different nodes as my permission. that I have to view these particular types of data as an example what I can also do is that And for example look at this from the point of view of one of one of my colleagues, which she she has access to the data that was produced in our in our group. This is basically like in biological data regarding histopathological samples, for example. But she will not have access to the clinical data. So if we just view these as as her own, for example, then we’ll see that if we hover over there and some the current nodes, which for example that she’s not able to access patient information, within the ontology, but then she has access to the nodes coloured in blue. So next we would like to show you the three applications that we built using the foundry application.Clinical Trial Data Splitting Tool [T-03:10:28]So the first application is clinical trial data splitting tool where we use this tool to split certain sub cohorts from POETIC into training, set testing and validation sets. And this is for the ease of future collaboration with external collaborators. So here we we have four modules for this application. So the first module we can just input the data set name and requestor, who this will be shared with and however this tool is only accessible by certain management level. So if here me and Ferran to request and define a cohort today, it won’t work. But I can still walk you through each of the module and what we have and what we can do within this module. So the second module is to define the cohort where we can select a certain subgroup of patients based on, you know, different parameters that were included here, such as did they receive peri-operative aromatase inhibitor and what are their baseline breast cancers intrinsic subtypes are they ER-positive / negative or baseline grades, surgery grades. So if we select a certain cohort and then we can then go into the next step, which is sample the cohort, here, we can set the training ratio testing ratio and an evaluation/validation set ratio and then the application will split them based on the ratio, but making sure that the treatment arm and HER2 status is balanced. So it’s like a stratified sampling. And once we have this cohort sampled, we can look at the distribution, then we can see whether we like it or not, if we think everything is good and then going to submit for creation where we can submit the cohort and then whoever the cohort was created for or received notification, and then they can then access only certain type of data. So in this case, the clinical data survival data of the patients will not be visible for those people. And here we can also look have a previously defined cohort and the data of the training testing set splits. However, as I mentioned earlier, we don’t have access to to this application. So we can’t really see anything here and next I would like to show you the second application, The POETIC sample cohorting and analysisPOETIC Sample Cohorting &amp;amp; Analysis [T-06:34:38]So this application was built mainly for internal use, for our internal analysts and bioinformaticians And so basically we also first select a sub cohort that we are interested in so we can, you know, look at this cohort and then do some either on the fly analysis or some more sophisticated analysis and similar to the previous application, we can select a subset of patients based on different parameters. For example, received peri-operative aromatase inhibitor or not their HER2 status, maybe we want to look at HER2-positive breast cancer patients. And once we have this, we can then go into analysis. And so in the analyses page it will first have two on the fly analyses including class distribution based on different factors that are selected here and also UMAP of gene expressions for the patients that have gene expression data available. And in this section we can also select previously defined cohorts to review to do more analysis and within the selected cohort we can also further filter out patients that have certain type of data, for example in this case imaging data. And for each patient that is shown here, we can also open a patient 360 view where it takes us to a very comprehensive view of the patient, including the different types of object that links to a patient, some of the basic information from patients and here we can we can see this in member states is where that we have to require additional permission to have a view of the survival data of patients and here we can look at the images that’s available for this patient, including spatial transcriptomic images. H&amp;amp;E slide and Ki67 staining and here we have this direct comparison for clinicopathological variables of the patient at baseline and on-treatment/surgery. And then we can also look at gene expression data where we can search specific genes, for example, here. ESR1 here we can see that the baseline ESR1 as well as at surgery, you can add more genes. For example, MKI67 and we can see that in the on-treatment surgery Ki67 value downregulated after two weeks treatment. And back here we have two more buttons. One is Run Analysis where we… it’s basically running these two analysis and we can change the parameters inside for example the number of k in K-Means clustering. And another button is to perform additional analysis in R, which takes us to Code Workbook application where you can build a pipeline to run analysis on selected cohorts from the cohorting tool this is an example for that. So we have datasets. And R transformation, and then we plotted some plots. So it’s very highly customizable. And yeah for each of the blocks we can have a look at the code that we used and we can also view the plots produced from the code.POETIC ML Image Explorer [T-11:36:38]And next we will show you the final application we built. It’s the POETIC ML machine learning image review So now this application, which could also be accessed through their patient 360 view that Xixuan showed us earlier and can be used to look at the three different types of imaging modalities that we have within these cohort in Foundry. So the first one of those would be their, fluorescent images from spatial transcriptomics datasets that we have, which is again, a small selection of the whole cohort. And then we also have Ki67 IHC whole slide images as well as Hematoxylin and Eosin stain images as well. So the first of all, these modalities, the one that we currently have in here is, is this a spatial transcriptomics technology which is based on looking at the gene expression profile of regions of interest or ROIs. And the idea here is that for all of the patients for which we have these type of data, these data mortality before and after and after surgery, what we can do is we can explore the actual image itself. We can also look at what the different regions of interests were taken. So this is taken with the aid of the pathologist that actually identifies the zones of interest within the tumour location or invasive boundaries and this kind of high level features. And then we can actually explore explore the different information for each of the different ROIs. So, for example, if we’re looking at ROI number number four, and you can actually look in here and you can see that this is like a tumour rich ROI, for example, that has a moderate number of fibroblasts and atypia score of two doesn’t really have a lot of lymphocyte infiltrates in this area. And we also have this button here to get the ROI details, which basically would query a whenever a new image is added into the into the Foundry presentation for POETIC it would query and get access to all of these ROI properties in as well as this modality. Again as I mentioned earlier, we also have staining for Ki67, which is a proliferation or cell division marker. And again you can look at all of the patients that have Ki67 stained slides here. We can also look at the actual or the actual like an overview of the actual image itself. You can look at where the tissue is standing for in these kind of modalities. Is this it would appear as a as a brownish colour. What we do is not just have a button to compute the percentage of positively stained Ki67 cells but you can also compare these directly with the data from hotspot analysis. So this is another kind of of technology that also measures expression of Ki67 but is not based on these actual images themselves. So it’s kind of like an alternative approach. And then you can still see and compare on that patient patient basis. You can see how the two modalities compare. Basically, the scores for these for this proliferation metrics where we can compare across modalities. And as well as looking at these I’m looking at the images and comparing them visually with the hotspot data. We also have a pipeline in the in the backend that computer pixel-wise H score, which essentially looks at them and classifies pixels based on the possible Ki67 intensity levels, and then also get an aggregate score for each of the each of the slides So these can be compared. And to do that actually we also have another of those workbooks that Xixuan showed earlier with within the sample cohorting analysis tool. Finally the last modality hematoxylin and eosin stained slides in here as you can see basically we have some build-in test annotations with the idea that this modality of the imaging basically is very useful to look at overall tissue tissue morphology. And this actually where we can also talk about the functionality within Foundry to flag and tag images or any kind of other data for particular follow up or for certain actions to be taken to the we take I guess So for example, in here we can just talk about, for example, there are some areas here of course, of this light that have mostly fatty tissue. So annotations can be can be created and you can actually select the area with the fatty tissue we want to see that these area we can save this annotation fatty tissue could even change the colour of the of the of the mark for sample we can change it to yellow we can submit this and then we should see basically that not just for for my particular use of viewing this image, but then for any other user that has permission to look at these images, they will then be able to see my own annotations, see who made them, see when they were made. And any other kind of comments that you might want to add them here. And again, for example, if if an image wasn’t for sufficient quality actions could be taken, for example, so for a rescan of the of the image or even like a any other kind of corrective procedure here. And as with the other modalities as well, we have H&amp;amp;E stained images for a considerable number of patients within the POETIC clinical trial. And here, for example, we’ll look at one of our case studies, which is 2210B you can see here as well, this, this beautiful, hematoxylin and eosin stained slide We have two sections of tissue with another a third one containing mostly, mostly fatty tissue. And we’ll use this one basically to to showcase the other kind of more quantitative analysis that could be performed in foundry. So these are powered essentially by Python transformations and Python python packages is we have developed and implemented, which we can run locally however they are running on the cloud in Foundry so these can be run from any kind of device even a thin and light laptop and for example you can use an intensity based approach to detect the tissue in the image. So basically we’ll kind of say what you actually have cellular tissue within these slides and we can also use, for example, a deep learning approach in this case, which is an off the shelf Cellpose model. But again, because the actual backend is written in Python, everything is fully modular and customizable. So when we kind of like in-house, in-house model could be used or an alternative off-the-shelf one, but you also have the ability here." }, { "title": "Presenting the IDD platform at the EACR Cancer Multiomics conference", "url": "/posts/EACRpposterIDD/", "categories": "Conference/Event, Poster", "tags": "", "date": "2024-04-30 01:00:00 +0100", "snippet": "This is a stub entry discussing my experience at this year’s EACR Cancer Genomics, Multiomics and Computational Biology conference in Bergamo.Building a Platform for Integrative Discovery and Diagnostics in Cancer A PDF copy of this poster’s abstract can be downloaded from here, and cited via DOI: 10.6084/m9.figshare.26414029" }, { "title": "PhD &amp; Thesis", "url": "/posts/PhD/", "categories": "", "tags": "", "date": "2023-10-01 01:00:00 +0100", "snippet": "" }, { "title": "Graph Signal Processing workshop 2023", "url": "/posts/GSPw23/", "categories": "Conference/Event, Collaboration", "tags": "", "date": "2023-06-15 01:00:00 +0100", "snippet": "This is a stub entry discussing my experience at this year’s Graph Signal Processing workshop in Oxford.I attended together with collaborators Aarthi Venkat and Prof. Smita Krishnaswamy, where we brought work on learning embeddings of directed gene-gene networks.Aarthi presented the work as an amazing talk during the second day!And of course, we also had lots of fun; including a formal dinner at an Oxford’s college and a posh afternoon tea!Learning directed and hyperbolic gene embeddings A PDF copy of this paper can be downloaded from here" }, { "title": "Big -omic Data and GPU acceleration with CUDA", "url": "/posts/SilverblueBigDataCUDA/", "categories": "Research, Linux", "tags": "", "date": "2023-05-15 01:00:00 +0100", "snippet": "As part of the peer-review process of Cardoso Rodriguez &amp;amp; Qin et al. 2023, we decided to compare our murine organoid data with publicly available patient cohorts of Colorectal Cancer. While some of the workflows were suited for the HPC, dataset exploration benefits from the agility of local compute. Now, with Variational AutoEncoder approaches for data integration implemented in PyTorch, my laptop’s GPU was more than adequate for this.Utilizing CUDA for -omic Data IntegrationTo integrate single-cell (sc) -omic public data, methods such as Canonical Correlation Analysis (CCA) or Robust Principal Component Analysis (rPCA) can be employed. State-of-the-art techniques based on Variational Autoencoders (VAEs) can benefit significantly from GPU acceleration provided by CUDA. However, CUDA requires the installation of the proprietary NVIDIA driver, which might not be straightforward in Silverblue due to the unique characteristics of rpm-ostree. If using PyTorch and JAX from a Conda environment, care must be taken to ensure both frameworks can access the CUDA installation.Installing the NVIDIA DriverTo install the NVIDIA driver, follow the instructions provided by RPM Fusion: https://rpmfusion.org/Howto/NVIDIA#OSTree_.28Silverblue.2FKinoite.2Fetc.29. On Silverblue, a hack is required to load the proprietary NVIDIA driver. In some cases, it may be necessary to lower the secure boot settings or disable it completely. Additional information can be found in the following GitHub repository: https://github.com/CheariX/silverblue-akmods-keys.Setting up scvi-tools with CUDA on LinuxWhen installing scvi-tools through Conda, JAX cannot utilize CUDA unless you also install cuda-nvcc. Run the following command after installing PyTorch, CUDA, and other dependencies through Conda:conda install jax cuda-nvcc -c conda-forge -c nvidiaNext, install scvi-tools, Scanpy, and scikit-misc:conda install scvi-tools scanpy scikit-misc -c conda-forgeIf encountering issues, you can try creating a new empty environment and installing the necessary packages using mamba:mamba create -n myenv python=3.9conda activate myenvmamba install pytorch torchvision torchaudio pytorch-cuda=11.7 -c pytorch -c nvidiamamba install jaxlib jax cuda-nvcc -c conda-forge -c nvidiaconda install scvi-tools scanpy scikit-misc -c conda-forgeIncreasing Swap for Big CRC DatasetsTo handle large CRC datasets effectively, increasing the swap size is crucial. Long time usage (abuse really) will murder your disk longevity, but it does sure come convenient in a pinch!Use the following command to create a 64GB swap file:btrfs filesystem mkswapfile --size 64G $swapfileActivate the swap file with the following command:sudo swapon $swapfileThis can be automatically activated at boot too, but I only use it when working with Big Data locally." }, { "title": "Oxford Nanopore and their EPI2ME nextflow pipelines", "url": "/posts/NanoporeNextflow/", "categories": "Research, Collaboration", "tags": "", "date": "2023-05-01 01:00:00 +0100", "snippet": "This is a stub entry for some of my work helping a collaborator sequence and run some Oxford Nanopore data.The entry will include work troubleshooting a MinION Mk1C device, and exploring the nextflow-based EPI2ME pipelines provided by Oxford Nanopore (specifically in the context of running them in Docker, Podman and singularity containers)." }, { "title": "Fedora Silverblue 38 and a year of Linux and immutable OSes", "url": "/posts/FedoraRecap/", "categories": "Tech, Linux", "tags": "", "date": "2023-04-18 01:00:00 +0100", "snippet": "More than a year with Linux/GNE as main OS. Aim to move to open source projects. Celebrate with Fedora 38!" }, { "title": "Computing Krackhardt hierarchies with pykrack", "url": "/posts/pyKrack/", "categories": "Research, Tool", "tags": "", "date": "2023-03-20 00:00:00 +0000", "snippet": "Stub entry for the pyKrack tool.Explanation of the aims and tool will go here.This is a link to the code.This is a link to the docs." }, { "title": "VR Landscapes", "url": "/posts/VRland/", "categories": "Research, Tool", "tags": "", "date": "2023-03-15 00:00:00 +0000", "snippet": "Stub entry for the Valley-Ridge score and single-cell Waddington-like landscapes.Explanation of the aims and tool will go here.This is a link to the code.This is a link to the docs." }, { "title": "A Single-cell Perturbation Landscape of Colonic Stem Cell Polarisation", "url": "/posts/CSClandscape_Preprint/", "categories": "Research, Publication", "tags": "", "date": "2023-02-15 00:00:00 +0000", "snippet": "Stub entry for the preprint." }, { "title": "Mail, Calendar and M.Exchange in Linux", "url": "/posts/SilverblueCalMail/", "categories": "Tech, Linux", "tags": "", "date": "2023-01-15 00:00:00 +0000", "snippet": "Calendar, mail and exchange config for later reference.Email Setup for ThunderbirdSetting up email in Thunderbird can sometimes be challenging, especially when dealing with Eliapps and making the outgoing server work.Calendar SetupWhen it comes to Microsoft Exchange, integrating the calendar functionality can be a bit tricky. One workaround is to add the calendars to the Google platform using the “publish outlook function” and then importing the URL (.ics) into Google Calendar.Please note that while this method works on the web, it may not sync with the general Gnome online account system. Even if it works on Android, it might still fail to sync with the Gnome online accounts even after removing and re-adding the account.There is a way to force it to sync the published calendar but I didn’t have any luck with it…Alternative ApproachIf setting up calendars via IMAP in Thunderbird proves to be problematic, an alternative option is to obtain the URL (.ics) and add it as an internet calendar.The same approach can be followed for adding the Eliapps calendar as well (for the Yale account)." }, { "title": "Fedora Silverblue Setup", "url": "/posts/SilverblueSetup/", "categories": "Tech, Linux", "tags": "", "date": "2023-01-01 00:00:00 +0000", "snippet": "IntroductionFedora Silverblue is a Fedora spin that offers an immutable base managed by rpm-ostree.Here I will present my Siverblue set-up, with the main layered packages I have on top of the base image and some other modifications I have needed both for work and other projects. While this is mainly for my own records, I figured someone could benefit from it, so here we go!Layered Packages Visual Studio Code: While a Flatpak version exists, layering VS Code results in a better integrated application and doesn’t require of certain workarounds. Gnome-tweaks: A MUST HAVE for customizing the GNOME desktop environment. The Extension Manager flatpak pairs with it greatly. gstreamer1-plugin-openh264: Adding media playback codecs for seamless multimedia experiences. Onedrive: OneDrive Client for Linux project, which to my experience has been the most reliable FOSS Onedrive client in Linux. Setup synclist. Config file can remain unset since defaults work. ZSH: Current shell of choice. Openssl: This would be the least important one. Mainly used as a dependency by GSConnect (GNOME extension implementing KDEConnect)Shell Configuration Install ZSH using rpm-ostree and set it as the default shell with the following command: sudo lchsh $USER. Oh My Zsh to manage zsh. I like to go with the Powerlevel10k theme and the patched Meslo font. Don’t forget to set the it as the default font in your terminals Customize the theme by modifying the P10k.zsh file. Micromamba is also a great drop-in replacement for conda. Much faster and easier to deploy (install) in cloud environments too!Containers with Toolbox and PodmanGeneral notes: Utilize Toolbox containers for isolated development environments and easy management of software dependencies. Consider using Podman instead of Docker for running containers within Toolbox.MacOS Virtual Machine: I really wished I didn’t have to it, but in my research group we use mac-specific vector editing software for figure making so it’s a necessary evil. Note though that, for non collab projets, I have fully moved to SVG files and Inkscape as the editor (and haven’t really found any major issues except some tiny quirks). Explore the alternative of running macOS applications using the GitHub project OSX-KVM or running Docker-based solutions within a Toolbox container. OSX-KVM seemed like the best fit. Follow the optimization guide provided by Sick Codes on GitHub to optimize your virtual machine for Big Sur or other macOS versions. Create a general Fedora Toolbox container, install Zsh and Oh-My-Zsh, and set up KVM and associated virtual machine dependencies.Misc.Dropbox: Setup up with the flatpak app. Sadly there is no smart sync functionality so beware of disk usage!Also installed (Dropbox nautilus integration)[https://www.dropbox.com/install-linux]." }, { "title": "Traveling across the USA", "url": "/posts/USA/", "categories": "Travel, USA", "tags": "", "date": "2022-11-01 00:00:00 +0000", "snippet": "Stub entry for the travels done across the USA with my girlfriend (now fiance!) during summer and autumn of 2022." }, { "title": "UCL-Yale collaboration", "url": "/posts/Yale/", "categories": "Learning, Collaboration", "tags": "", "date": "2022-08-31 01:00:00 +0100", "snippet": "Stub entry for the 3 month stay at Prof. Smita Krishnaswamy (Yale University) working with Aarthi Venkat on developing new methods to analyse multi-omics data to characterise inter- and intra-cellular communications using graph-based approaches." }, { "title": "FastAI course 2022", "url": "/posts/fasAI_intro/", "categories": "Learning, fastAI", "tags": "", "date": "2022-08-04 01:00:00 +0100", "snippet": "Just before going on a 3 month long exchange at Yale University, as part of the UCL-Yale Exchange programme, I decided to start 2022’s edition of the FastAI course.I followed the course mostly in an asynchronous manner, and will finish it at some point in 2023 when I will update this blog post entry with some interesting results, highlights of what I learned and my overall impressions on it.nbdevAt the technical/deployment level, one of the things that surprised the most was the concept of using Jupyter Notebooks not only for exploration but also for building the backbone of packages, perform unit testing and build documentation.All of this can be done through nbdevFrom nbdev’s siteThis philosophy really puts forward the idea of readability and openness at all levels, so I decided to apply it to a couple of upcoming projects.Stay tunned for that!If you want to try it out yourself, check out their step-by-step guide here." }, { "title": "Recent Discoveries @ the CI 2022 conference", "url": "/posts/RecentDiscoveriesCI/", "categories": "Conference/Event, Talk", "tags": "", "date": "2022-07-01 01:00:00 +0100", "snippet": "The aim of this post is to improve the accessibility of the talk given at the Cancer Institute 2022 conference as part of the Recent Discoveries series.This is an improved iteration of the talk given one month earlier at the Wellcome Single Cell Conference 2022. See the talk slides and transcript notes in that entry." }, { "title": "Wellcome Single Cell Conference 2022", "url": "/posts/WellcomeSC22/", "categories": "Conference/Event, Talk", "tags": "", "date": "2022-06-05 01:00:00 +0100", "snippet": "The aim of this post is to improve the accessibility of the talk given at the Wellcome Single Cell Conference 2022 by providing with the notes used for the oral presentation.An improved iteration of this talk was given at the Cancer Institute 2022 conference as part of the Recent Discoveries series.The work presented in this talk eventually developed into that shown in Cardoso Rodriguez &amp;amp; Qin et al. 2023. A PDF copy of the slides can be downloaded from hereIntroduction (1/10 &amp;amp; 2/10)Intrinsic and Extrinsic Cues as Cell Fate RegulatorsIt is understood that both intrinsic and extrinsic cues are crucial in determining cell fate. As Intrinsic cues we might have mutations, a cell’s epigenetic state, and transcriptional networks. As for extrinsic cues, we might have mechanobiological signals, metabolites or growth factors.Now, in a cancerous cell we know that intrinsic cues such as oncogenic mutations are key when controlling cell fate, but so are the extrinsic cues coming from the tumour microenvironment.Here at the tape lab and in this project in particular are interested in understanding how do oncogenes and the TME regulate cell fate in the context of Colorectal Cancer.Single-cell Technologies to Study CRC OrganoidsCRC is a very common cancer, claiming 800 thousand worldwide deaths per yearMuch like other cancers it presents as a collection of malignant and non-transformed cells, resulting in a complex heterocellular setting where colonic epithelia closely interacts with the surrounding tumour microenvironment, consisting among others of stromal fibroblasts and myeloid macrophages.In fact, TME is key factor in CRC, with increased stromal and myeloid components correlating with worse prognosis.In order to study this disease we model it using organoids, self assembling 3D structures that we can grow in vitro in heterocellular settings that can mimic the TME.Such a heterogenous system requires of single-cell technologies to be properlycharacterised.Mass cytometry is easily scalable and ideal to study intra-cellular communications via PTMs. On the other hand, scRNA-seq can be used to describe inter-cellular communication by looking at the expression of ligands and receptors between cells.Experimental setup and methods (3/10)Multivariate scRNA-seq of CRC-TME OrganoidsTo explore how intrinsic oncogenes and extrinsic stromal cues regulate colonic epithelial fate we performed a multivariate scRNA-seq analysis of organoids.In it we had organoids ranging from WT to those progressively harbouring mutational hallmarks of CRC, either in a monoculture or co-cultured with colonic fibroblasts and/or macrophages. Furthermore we also included a WT monoculture grown with exogenous WNT3A, EGF, Nogging and R-spondin1 as a niche factor control.Analysed using scRNA-seq we were able to identify the three cell types in the system.We then focused on the epithelial compartment, with the main steps of the analysis shown here; including velocity, differential abundance, and cell-cell communication analysis.Results (4/10 - 9/10)scRNA-seq Captures Colonic Epithelia DifferentiationNow with a subset of just of the epithelial cells from the system (around 30k cells across 17 conditions), we were able to capture colonic epithelia differentiation.We identified clusters associated with the main colonic epithelia cell types;including a stem, secretory and absorptive populations.The overall dynamics of the system were also recovered, with SCENT’s CCAT entropy based metric indicating greater pluripotency estimates for the colonic stem cell clusters, as well as RNA velocity stream embeddings going towards the differentiated states.Now, it is important to note that instead of a monolithic colonic stem cellspopulation, we identified a heterogenous compartment with multiple statesOncogenes and Fibroblasts Differentially Regulate CSCWe then investigated when these multiple colonic stem cell states were being regulated using differential abundance analysis. Comparing our control WT monocultures with CRC organoids we saw a significant enrichment of cellular neighbourhoods associated with the proliferative Colonic stem cell population, shown in this PHATE embedding in red. Note also how the more differentiated late enterocyte cells are on the other hand being lost.On the other hand, we noticed how the addition of fibroblasts in the co-culture induced a clear enrichment of the revival CSC in the WT organoids.These 2 distinct and differentially regulated CSC populations where characterised using Differential Expression.As shown in this curated heatmap, proCSC are characterised by being particularly hyperproliferative and expressing Lgr5 and Birc5.RevCSC are quite distinct from the other colonic stem cells, being less proliferative and expressing Clusterin; their unique transcriptional signature matching that of the revival stem cell population in the intestine.Interestingly, while the CSC and proCSC clusters consist mostly of AK and AKP cells, the revCSC cluster is dominated by WT cells.Oncogenic Entrapment of the Colon EpitheliaThat is because it appears that the oncogenic mutations are trapping the colonic epithelia in an oncogenic state.First we have a summary of cluster abundance changes across all conditions.It clearly shows how the first 2 colonic stem cell clusters are being upregulated by the oncogenes, and how the revCSC are being induced in WT and ApcKD fibroblast co-cultures.However, there’s a clear loss of fibroblast regulation in AK and AKP organoids. Furthermore it seems like WENR is inducing all CSC states in wt organoids.We also used RNA velocity lengths to compare differentiation rates across organoids. We compared side-by-side our WT controls, WT+fibroblast cocultures, AK organoids and the WENR enriched condition,As you can see here the AK organoids showed the lowest velocity lengths (which was consistent with AKP organoids too).To explore the mechanisms behind this oncogenic entrapment we used cell-cell communication analysis of the fibroblast co-cultures across the different genotypes.With these plots we can compare the quantity of incoming and outgoing signals as detected by CellChat, with the arrows showing aggregate interaction strengths from the fibroblasts to the epithelia clusters.As we had expected, the fibroblasts appear to be predominantly characterised by outgoing signalling consistently across all genotypes.However, while the WT epithelia shows a high score for incoming signals it quickly dropped following the accumulation of oncogenic mutations.These results suggest that oncogenic mutations erode fibroblast to epithelia communication, with the CRC organoids acting as “bad listeners”.Exogenous Ligands Model CSC Regulation(Credit to Dr Xiao Qin)Now if you remember we had seen that WENR promoted all CSC states, so to explore how exogenous ligands model CSC regulation we used mass cytometry to analyse organoid monocultures across 60 different conditions with different genotypes and ligands.In this condition-based PHATE embedding we can see how: We can recapitulate the revCSC cells characterised by Clusterin expression. These cells seem to be associated with exogenous wnt3a and low MAPK and b-cat signalling. We can also see the Birc5 positive proCSC , which were characterised by high MAPK and b-cat signalling.Now using a Scaffold map centred around key genotypes we can see how oncogenesand the exogenous ligands navigate a shared regulatory landscape. If for example, we take a WT organoid and add exogenous WNT3A we will be promoting the revCSC. On the other hand, if we take an organoid with just oncogenic Kras (not sufficient on its own to trap the epithelia in a proCSC-like state) and add r-spondin we shift cell fate towards the proCSC.Summary (10/10)We have identified 2 distinct and differentially regulated CSC states:Intrinsic oncogenic cues seem to induce a hyper proliferative CSC populationWhereas extrinsic stromal cues induce the revCSCsOncogenic mutations are trapping the colonic epithelia in the hyperproliferative state.This seems to be due to the erosion of stromal regulation in CRC organoids.And is also suggested by the lowered differentiation rates in themFinally, it appears that both intrinsic and extrinsic cues navigate a shared regulatory landscapeRegulated by EGF and WNT signalling, up to the point until APC loss and oncogenic KRAS trap the organoids, turning them refractory towards the external cues" }, { "title": "UCL Cancer Domain Symposium 2022", "url": "/posts/UCLcancerDomain/", "categories": "Conference/Event, Poster", "tags": "", "date": "2022-05-11 01:00:00 +0100", "snippet": "The aim of this post is to host a copy of the poster presented at UCL Cancer Domain Symposium 2022, which was awarded with the first prize runner-up.The work presented in the poster eventually developed into that shown in Cardoso Rodriguez &amp;amp; Qin et al. 2023. The poster has been deposited in figshare under the following DOI:https://doi.org/10.5522/04/19753468.v1" }, { "title": "Ally Pally", "url": "/posts/allypally/", "categories": "Travel, UK", "tags": "", "date": "2019-08-26 00:00:00 +0100", "snippet": " This entry was originally posted on our travel blog; CoolAFIn this episode of Scooting Through…, we visit Alexandra Palace, in Wood Green. Alexandra Palace &amp;amp; Park are situated on a hill with views over London, and in clear days you can perfectly see the skyscrapers of the City and Canary Wharf against the sky, just as we show you in this video!Follow us scooting from our neighbourhood, Stoke Newington, into Ally Pally! And listen to our thoughts about getting there with the scooter :)If you liked this video, please subscribe and give us a like!" }, { "title": "Top beaches of Tarifa and Rota", "url": "/posts/rota/", "categories": "Travel, Europe", "tags": "", "date": "2019-07-26 00:00:00 +0100", "snippet": " This entry was originally posted on our travel blog; CoolAFCadiz is A’s usual family vacation destination on southern Spain, and this year we both managed to fly down there and squeeze out some days to visit some of the best, must-see beaches of Tarifa. Wanna see them with us?La família d’A baixa sempre a la costa de Cádiz a gaudir de l’estiu i aquest any ens ho hem pogut muntar per passar-hi uns dies amb ells. Bon menjar i bona vida, vam aprofitar per visitar unes de les millor platges de Tarifa. Us animeu a descobrir-les amb nosaltres?A siempre va a Cádiz con su familia en verano, y este año hemos pasado unos días allí, aprovechando para visitar las mejores playas de Tarifa. ¿Queréis conocerlas con nosotros?" }, { "title": "Walthamstow Wetlands", "url": "/posts/wetlands/", "categories": "Travel, UK", "tags": "", "date": "2019-06-02 00:00:00 +0100", "snippet": " This entry was originally posted on our travel blog; CoolAFSituated just 12km to the north of the city of London, Walthamstow Wetlands extend for more than 2km and is one of the largest urban wetland nature reserves in Europe, where wildlife and industrialism meet.These wetlands were founded and built between 1863 and 1904, providing drinking water to the rapidly growing population of London. In 1894, the Engine House was built and remained in service until the 1980s. Underneath the building was a network of underground reservoirs, chambers and pipes that linked the reservoirs. Now, these reservoirs support the most notable variety of breeding wetland birds among all of London’s drinking water reservoirs.Easy to reach thanks to Victoria Line, these wetlands are the perfect place to expend a nice morning exploring nature, looking for birds, or even fishing! Alternatively, you can choose to do a guided tour through these wetlands, learning more about its biosphere and importance.As you can see in the video, we decided to get there with our electric scooters and drive through Lea river, running just next to the wetlands. If you go, make sure to visit the top of the copper mill and admire the views of Alexandra Palace and the City of London :)" }, { "title": "Croatia Unplugged! Join us in our 8-day road trip through Croatia&#39;s coast", "url": "/posts/croatia/", "categories": "Travel, Europe", "tags": "", "date": "2019-05-23 00:00:00 +0100", "snippet": " This entry was originally posted on our travel blog; CoolAFWe flew to Croatia and did a road trip from Dubrovnik to Pag, going through Split, Krka, Zadar and Brač on the way back to Dubrovnik! We filmed bits of our travel with our Xiaomi 360 Mijia and our DJI Spark and here is the first part of the travel!Os llevamos por el sur del país, empezando por una pequeña parada en Dubrovnik, para luego conocer y hacer noche en Split. De allí, nos vamos a las cascadas del parque Krka, bastante vacío y con el agua fresquísima; y a Zadar, desde donde hacemos una escapada a la isla de Pag, una pequeña joya que descubrimos por casualidad. Finalmente, visitamos la isla de Brac, de la que nos enamora especialmente Zlatni Rat (el Cuerno Dorado), una lengua de tierra que se adentra hacia el mar, completamente vacía en primavera! Y todo esto es solo una parte del viaje! Dentro de poco nos adentraremos a fondo por las calles y murallas de Dubrovnik.Us durem pel sud del petit país, començant per una breu parada a Dubrovnik, per a després conèixer i fer nit a Split; un palau imperial romà fet ciutat. D’allà ens endinsarem al parc natural de Krka, per a tastar de primera mà com de freda és l’aigua de les seves cascades. A continuació anem fem via cap a Zadar, des d’on ens escapem una tarda a l’illa de Pag, una petita joia descoberta per casualitat. Finalment ens podreu acompanyar mentre visitem l’illa de Brač i gaudir tots plegats de Zlatni Rat (altrament conegut com a Cap Daurat), una banya de terra que s’endinsa a la mar.I tot això és només la primera part del viatge! En breus podreu acompanyar-nos per Dubrovnik!" }, { "title": "We&#39;ve got a drone!", "url": "/posts/drone/", "categories": "Travel, UK", "tags": "", "date": "2019-05-12 00:00:00 +0100", "snippet": " This entry was originally posted on our travel blog; CoolAFThis is the very heart of our neighborhood: Abney Park Cemetery and chapel. This cemetery is part of the Seven Magnificent of London and one of the first non-denominational cemeteries in the country, funded on 1840." }, { "title": "A greekly week!", "url": "/posts/greece/", "categories": "Travel, Europe", "tags": "", "date": "2019-03-03 00:00:00 +0000", "snippet": " This entry was originally posted on our travel blog; CoolAFWe flew to Greece last February and visited Athens, Poseidon´s temple, Delphi and Meteora. We filmed bits of our travel with our Xiaomi 360 Mijia and here is the result!" } ]
